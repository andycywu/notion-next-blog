# 🔧 NotionNext Blog 设置指南

## 📋 当前状态检查

如果您看到 "Hello World" 或 "无法获取Notion数据" 的提示，说明还需要完成以下配置。

---

## ✅ 第一步：检查 Cloudflare Pages 环境变量

### 1.1 访问 Cloudflare Dashboard

1. 打开浏览器，访问：**https://dash.cloudflare.com/**
2. 使用您的账号登录：`andywu719@gmail.com`
3. 在左侧菜单点击 **Pages**
4. 找到并点击项目 **notion-next-blog**

### 1.2 检查环境变量设置

1. 在项目页面，点击 **Settings**（设置）
2. 在左侧菜单找到 **Environment variables**（环境变量）
3. 检查以下**必需变量**是否已设置：

#### ✅ 必需变量（必须设置）

| 变量名 | 值 | 类型 | 说明 |
|--------|-----|------|------|
| `NOTION_PAGE_ID` | `02ab3b8678004aa69e9e415905ef32a5` | Secret 或 Plain text | Notion 数据库页面 ID |

**如何设置：**
1. 点击 **Add variable**（添加变量）
2. 变量名：`NOTION_PAGE_ID`
3. 值：`02ab3b8678004aa69e9e415905ef32a5`
4. 环境：选择 **Production**（或 **Apply to all environments**）
5. 类型：可以选择 **Plain text**（因为这是公开的 Notion 页面 ID）
6. 点击 **Save**（保存）

#### 📝 推荐变量（建议设置）

| 变量名 | 值 | 类型 | 说明 |
|--------|-----|------|------|
| `NEXT_PUBLIC_CONTACT_LINKEDIN` | `https://www.linkedin.com/in/andycywu/` | Plain text | LinkedIn 链接 |
| `NEXT_PUBLIC_AUTHOR` | `Andy C. Y. Wu` | Plain text | 作者名称 |
| `NEXT_PUBLIC_BIO` | `您的简介` | Plain text | 作者简介 |
| `NEXT_PUBLIC_LINK` | `https://notion-next-blog.andycywu.workers.dev` | Plain text | 网站地址 |
| `NEXT_PUBLIC_TITLE` | `您的博客标题` | Plain text | 博客标题 |
| `NEXT_PUBLIC_THEME` | `simple` | Plain text | 主题名称（可选） |

---

## ✅ 第二步：检查 Notion 数据库配置

### 2.1 确认 Notion 页面 ID

您的 Notion 页面 ID 应该是：`02ab3b8678004aa69e9e415905ef32a5`

**如何验证：**
1. 打开您的 Notion 页面
2. 在浏览器地址栏中，URL 格式应该是：
   ```
   https://www.notion.so/your-workspace/02ab3b8678004aa69e9e415905ef32a5
   ```
3. 确认页面 ID 是否正确

### 2.2 确认 Notion 数据库类型

您的 Notion 页面**必须是数据库类型**，不能是普通页面。

**如何检查：**
1. 打开您的 Notion 页面
2. 页面应该显示为一个**表格视图**（Table view）
3. 如果看到的是普通页面，需要：
   - 创建一个新的数据库页面
   - 或者将现有页面转换为数据库

### 2.3 确认数据库权限

**重要：** Notion 数据库必须是**公开的**（Public），或者您需要设置认证。

**如何设置公开：**
1. 在 Notion 页面右上角，点击 **Share**（分享）
2. 点击 **Share to web**（分享到网页）
3. 确保 **Allow duplicate as template**（允许作为模板复制）已启用
4. 复制链接，确认可以公开访问

**如果使用私有数据库：**
需要设置以下环境变量（在 Cloudflare Dashboard 中设置为 **Secret** 类型）：
- `NOTION_TOKEN_V2` - Notion API Token
- `NOTION_ACTIVE_USER` - Notion Active User ID

---

## ✅ 第三步：检查构建配置

### 3.1 检查构建命令

在 Cloudflare Pages 项目设置中：

1. 进入 **Settings** > **Builds & deployments**
2. 确认以下设置：

| 设置项 | 值 |
|--------|-----|
| **Build command** | `npm run build` |
| **Build output directory** | `.next` |
| **Root directory** | `/`（根目录） |
| **Framework preset** | `Next.js` |

### 3.2 重新部署

修改环境变量后，需要重新部署：

1. 在项目页面，点击 **Deployments**（部署）
2. 找到最新的部署记录
3. 点击右侧的 **...** 菜单
4. 选择 **Retry deployment**（重新部署）
5. 或者点击 **Create deployment**（创建部署）> **Retry build**（重新构建）

---

## ✅ 第四步：验证配置

### 4.1 检查部署日志

1. 在 **Deployments** 页面，点击最新的部署
2. 查看 **Build logs**（构建日志）
3. 查找以下信息：
   - ✅ 构建成功
   - ✅ 环境变量已加载
   - ❌ 如果有错误，查看错误信息

### 4.2 检查网站功能

部署完成后，访问您的网站：**https://notion-next-blog.andycywu.workers.dev**

**应该看到：**
- ✅ 博客首页正常显示
- ✅ 文章列表显示
- ✅ 不是 "Hello World" 或错误提示

**如果仍然看到错误：**
1. 检查浏览器控制台（F12）的错误信息
2. 检查构建日志中的错误
3. 确认 `NOTION_PAGE_ID` 环境变量已正确设置

---

## 🔍 故障排除

### 问题 1：仍然显示 "Hello World" 或 "无法获取Notion数据"

**可能原因：**
1. 环境变量未设置或设置错误
2. Notion 数据库不是公开的
3. Notion 页面 ID 不正确

**解决方法：**
1. 在 Cloudflare Dashboard 中确认 `NOTION_PAGE_ID` 已设置
2. 确认值是正确的：`02ab3b8678004aa69e9e415905ef32a5`
3. 重新部署项目
4. 清除浏览器缓存并刷新

### 问题 2：构建失败

**可能原因：**
1. 构建命令错误
2. 依赖安装失败
3. 环境变量格式错误

**解决方法：**
1. 检查构建日志中的具体错误
2. 确认构建命令是 `npm run build`
3. 确认 Node.js 版本是 20+

### 问题 3：Notion 数据无法加载

**可能原因：**
1. Notion 数据库权限问题
2. Notion API 限制
3. 网络连接问题

**解决方法：**
1. 确认 Notion 数据库已设置为公开
2. 检查 Notion 页面是否可以正常访问
3. 如果使用私有数据库，设置 `NOTION_TOKEN_V2` 和 `NOTION_ACTIVE_USER`

---

## 📝 快速检查清单

在继续之前，请确认：

- [ ] 已在 Cloudflare Dashboard 中设置 `NOTION_PAGE_ID` 环境变量
- [ ] `NOTION_PAGE_ID` 的值是：`02ab3b8678004aa69e9e415905ef32a5`
- [ ] Notion 数据库已设置为公开（Public）
- [ ] Notion 页面是数据库类型（Table view）
- [ ] 构建命令设置为 `npm run build`
- [ ] 已重新部署项目
- [ ] 网站可以正常访问并显示内容

---

## 🚀 下一步

完成以上设置后：

1. **等待部署完成**（约 3-5 分钟）
2. **访问网站**：https://notion-next-blog.andycywu.workers.dev
3. **验证功能**：确认博客内容正常显示
4. **自定义配置**：根据需要添加更多环境变量

---

## 📞 需要帮助？

如果遇到问题：

1. 查看构建日志中的错误信息
2. 检查 Cloudflare Dashboard 中的环境变量设置
3. 确认 Notion 数据库配置正确
4. 参考文档：[CLOUDFLARE_DEPLOYMENT.md](./CLOUDFLARE_DEPLOYMENT.md)

---

**现在就开始设置吧！** 🎉
